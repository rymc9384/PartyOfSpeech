rm(list=ls())
library(stringr)
library(optparse)
options(stringsAsFactors = F)
## Parse command line arguments:
option_list <- list(
make_option(c("-i", "--infile"), type="character", default="D:/cong_text/final_pos/topic_lemtag_merged_114.csv",
help="Merged topic lemma file [default=%default]", metavar="character"),
make_option(c("-lf", "--logfile"), type="character", default="./noun_ratios.Rout",
help="logfile name [default= %default]", metavar="character"),
make_option(c("-o", "--outfile"), type="character", default="D:/cong_text/final_pos/analysis/noun_ratios.RData",
help="ttest out file w/ path [default= %default]", metavar="character")
)
opt_parser <- OptionParser(option_list=option_list)
opt <- parse_args(opt_parser)
noun_ratio <- function(grams){
n.count <- str_count(string = grams, pattern = "NNS?"
n.ratio <- sum(n.count) / length(grams)
return(n.ratio)
}
noun_ratio <- function(grams){
n.count <- str_count(string = grams, pattern = "NNS?")
n.ratio <- sum(n.count) / length(grams)
return(n.ratio)
}
merged <- read.csv(opt$infile)
merged$nouns <- NA
for (i in 1:nrow(merged)){
grams <- get_tags(text = merged$lemma_text[i])
merged$nouns[i] <- noun_ratio(grams = grams, propernouns = TRUE)
}
get_tags <- function(text){
grams <- unlist(str_split(text, ' '))
grams <- gsub(pattern = ".*_", replacement = '', grams)
return(grams)
}
merged$nouns <- NA
for (i in 1:nrow(merged)){
grams <- get_tags(text = merged$lemma_text[i])
merged$nouns[i] <- noun_ratio(grams = grams, propernouns = TRUE)
}
for (i in 1:nrow(merged)){
grams <- get_tags(text = merged$lemma_text[i])
merged$nouns[i] <- noun_ratio(grams = grams)
}
r.nn <- merged$nouns[merged$party=="R"]
d.nn <- merged$nouns[merged$party != "R"]
nn.ttest <- t.test(x = r.nn, y = d.nn, mu = 0.00, var.equal = FALSE)
print(nn.ttest)
nn.ttest <- t.test(x = r.nn, y = d.nn, mu = 0.01, var.equal = FALSE)
print(nn.ttest)
noun_ratio <- function(grams){
n.count <- str_count(string = grams, pattern = "NNS?(?=$)")
n.ratio <- sum(n.count) / length(grams)
return(n.ratio)
}
merged$nouns <- NA
for (i in 1:nrow(merged)){
grams <- get_tags(text = merged$lemma_text[i])
merged$nouns[i] <- noun_ratio(grams = grams)
}
r.nn <- merged$nouns[merged$party=="R"]
d.nn <- merged$nouns[merged$party != "R"]
nn.ttest <- t.test(x = r.nn, y = d.nn, mu = 0.01, var.equal = FALSE)
print(nn.ttest)
nn.ttest$conf.int * 100
mean(r.nn - d.nn)
mean(r.nn) - mean(d.nn)
sd(r.nn)
sd(d.nn)
summary(c(r.nn, d.nn))
